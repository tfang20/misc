Sub DownloadXLSFile()
    ' Replace "YOUR_API_URL_HERE" with the actual API endpoint that returns the XLS file
    Dim apiURL As String
    apiURL = "YOUR_API_URL_HERE"
    
    ' Replace "YOUR_SPECIFIC_PATH_HERE" with the desired download path on your computer
    Dim savePath As String
    savePath = "YOUR_SPECIFIC_PATH_HERE\filename.xls"
    
    ' Create a new instance of MSXML2.XMLHTTP object
    Dim xmlHTTP As Object
    Set xmlHTTP = CreateObject("MSXML2.XMLHTTP")
    
    ' Open the URL and make the API call
    xmlHTTP.Open "GET", apiURL, False
    xmlHTTP.send
    
    ' Check if the API call was successful (Status code 200)
    If xmlHTTP.Status = 200 Then
        ' Create a new ADODB.Stream object to save the file
        Dim stream As Object
        Set stream = CreateObject("ADODB.Stream")
        
        ' Set the stream type to binary
        stream.Type = 1
        
        ' Open the stream and write the API response (XLS file) to it
        stream.Open
        stream.Write xmlHTTP.responseBody
        stream.SaveToFile savePath, 2 ' 2 = adSaveCreateOverWrite
        
        ' Close the stream and release objects
        stream.Close
        Set stream = Nothing
        Set xmlHTTP = Nothing
        
        MsgBox "XLS file downloaded successfully to " & savePath
    Else
        MsgBox "Failed to download the XLS file. Status code: " & xmlHTTP.Status
    End If
End Sub
