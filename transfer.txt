import openpyxl
from openpyxl.styles import Alignment, Border, Side, Font

def format_excel_file(filename):
    wb = openpyxl.load_workbook(filename)
    ws = wb.active

    # Bold the first row
    for cell in ws[1]:
        cell.font = Font(bold=True)

    # Center all cells
    for row in ws.iter_rows():
        for cell in row:
            cell.alignment = Alignment(horizontal='center', vertical='center')

    # Add a thick border around the first row
    border = Border(top=Side(style='thick'), right=Side(style='thick'), bottom=Side(style='thick'), left=Side(style='thick'))
    for cell in ws[1]:
        cell.border = border

    # Add a regular bottom border under the row when col C contains the text "here"
    for row in ws.iter_rows(min_row=2, min_col=3, max_col=3):
        for cell in row:
            if cell.value == "here":
                cell.border = Border(bottom=Side(style='thin'))

    # Add a regular border to the right of column F
    for row in ws.iter_rows(min_col=6, max_col=6):
        for cell in row:
            cell.border = Border(right=Side(style='thin'))

    # Save the changes to the file
    wb.save("formatted_" + filename)

# Usage:
format_excel_file("file.xlsx")
