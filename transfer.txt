import pandas as pd

# Assuming you have 4 dataframes named df1, df2, df3, and df4

# Create an empty list to store the columns with the text "here" in row "period"
selected_columns = []

# Function to check if the "period" row contains the text "here" and save the column if true
def check_period_contains_here(df):
    if "period" in df.index and df.loc["period"].str.contains("here").any():
        selected_columns.extend(df.columns[df.loc["period"] == "here"].tolist())

# Call the function for each dataframe
check_period_contains_here(df1)
check_period_contains_here(df2)
check_period_contains_here(df3)
check_period_contains_here(df4)

# Create a new dataframe with the selected columns
result_df = pd.concat([df1[selected_columns], df2[selected_columns], df3[selected_columns], df4[selected_columns]], axis=1)

# Return the new dataframe
result_df
