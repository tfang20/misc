Option Explicit

Sub GetAPIDataAndPaste()
    Dim apiLink As String
    apiLink = "YOUR_API_LINK_HERE" ' Replace with your actual API link
    
    Dim httpReq As Object
    Set httpReq = CreateObject("WinHttp.WinHttpRequest.5.1")
    
    ' Send a GET request to the API
    httpReq.Open "GET", apiLink, False
    httpReq.send
    
    ' Check if the request was successful (status code 200)
    If httpReq.Status = 200 Then
        Dim response As String
        response = httpReq.responseText
        
        ' Split the response into an array using the comma as the delimiter
        Dim dataArray As Variant
        dataArray = Split(response, ",")
        
        ' Specify the worksheet where you want to paste the data
        Dim ws As Worksheet
        Set ws = ThisWorkbook.Sheets("Sheet1") ' Replace "Sheet1" with your desired sheet name
        
        ' Clear the existing data in the worksheet
        ws.UsedRange.Clear
        
        ' Paste the data into the worksheet
        ws.Range("A1").Resize(UBound(dataArray) + 1, 1).Value = Application.WorksheetFunction.Transpose(dataArray)
        
        MsgBox "Data has been successfully retrieved and pasted.", vbInformation
    Else
        MsgBox "Error: Unable to retrieve data from the API.", vbExclamation
    End If
    
    Set httpReq = Nothing
End Sub
